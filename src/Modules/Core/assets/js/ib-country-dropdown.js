jQuery(document).ready(function($){0!=$('[data-type="country"]').length&&0!=$('[data-type="state"]').length&&$('[data-type="country"]').on("change",function(){var country_id=$(this).val(),state={},$form=$(this).closest("form"),$state=$('[data-type="state"]',$form),classes=$state.attr("class");if($state.find("option").remove().end(),$.each(ibLocals.ibState,function(key,value){value.country_id==country_id&&(state[value.state_abbr]=value.state_name)}),!$.isEmptyObject(state)&&$state.is("input")){$state.replaceWith('<select name="state" data-type="state" class="'+classes+'">');var $state=$('[data-type="state"]',$form);$.each(state,function(key,value){$state.append(new Option(value,key))})}else $.isEmptyObject(state)||$state.is("input")?$state.replaceWith('<input name="state" type="text" data-type="state" class="'+classes+'">'):$.each(state,function(key,value){$state.append(new Option(value,key))})})});