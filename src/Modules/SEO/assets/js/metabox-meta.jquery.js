!function($){$.fn.ib_metaboxMeta=function(method){var _ibThis,file_frame,methods={init:function(options){_ibThis=$(this),$(settings.set_image_selector).click(function(e){e.preventDefault(),methods.ib_chooseMetaPreviewImage($(this))})},ib_chooseMetaPreviewImage:function($button){file_frame?file_frame.open():(file_frame=wp.media.frames.file_frame=wp.media({title:jQuery(this).data("uploader_title"),button:{text:jQuery(this).data("uploader_button_text")},multiple:!1}),file_frame.on("select",function(){attachment=file_frame.state().get("selection").first().toJSON(),console.log(attachment),methods.ib_setMetaPreviewImage(attachment,$button)}),file_frame.open())},ib_setMetaPreviewImage:function(attachment,$button){var imgurl=attachment.url;if(attachment.sizes.thumbnail)var thumbnail=attachment.sizes.thumbnail.url;else var thumbnail=attachment.url;var $parent=(attachment.id,$button.parent());$parent.find(".ib-meta-preview-image").html('<img src="'+thumbnail+'">'),$parent.find("#ib_meta_image_thumbnail").val(thumbnail),$parent.find("#ib_meta_image").val(imgurl),$parent.find("#ib_meta_image_size").val(attachment.filesizeInBytes);var $twitterSettings=$("#ib_post_settings_list_twitter");$twitterSettings.length&&$twitterSettings.ib_postSettings("ib_checkImageForTwitter",attachment)}},defaults={data:"",set_image_selector:"#ib_set_meta_image_button"};if(methods[method])return methods[method].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof method||!method){var settings=$.extend({},defaults,method);return this.each(function(){_ibThis=$(this),methods.init()})}$.error("Method "+method+" does not exist on jQuery.ib_metaboxMeta")}}(jQuery);