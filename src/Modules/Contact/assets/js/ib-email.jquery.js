jQuery(document).ready(function($){function handleToggleFeatures($checkbox){var containerName=$checkbox.attr("data-name");console.log($checkbox.closest("table")),console.log("container "+containerName),$checkbox.is(":checked")?$checkbox.closest("table").find('tr[data-container="'+containerName+'"]').hide():$checkbox.closest("table").find('tr[data-container="'+containerName+'"]').show()}function showOverlay(){if(!overlay_showing){overlay_showing=!0,$(window).resize(function(){positionOverlay()});var $buttonInForm=$("#save_button_in_form");$("#save_changes_button").click(function(e){$buttonInForm.trigger("click")}),$buttonInForm.show(),$previewIframe=$("#ib-email-template-iframe"),$emailContent=$previewIframe.contents().find("#main-table"),positionOverlay()}}function positionOverlay(){var position=$previewIframe.position(),height=$emailContent.height()+5;$("#ib-overlay").css({position:"absolute",display:"table","z-index":"10",height:height,width:$previewIframe.width()+5,top:position.top,left:position.left})}var file_frame;$("#upload_email_logo_image").click(function(e){e.preventDefault(),file_frame&&file_frame.open(),file_frame=wp.media.frames.file_frame=wp.media({title:jQuery(this).data("uploader_title"),button:{text:jQuery(this).data("uploader_button_text")},multiple:!1}),file_frame.on("select",function(){attachment=file_frame.state().get("selection").first().toJSON();var imgurl=attachment.url;$("#logo_image").val(imgurl),showOverlay()}),file_frame.open()});var $noLogo=$("#no_logo_container");$noLogo.click(function(){handleToggleFeatures($noLogo)}),$noLogo.is(":checked")&&handleToggleFeatures($noLogo);var $noHeaderShare=$("#no_social_container");$noHeaderShare.click(function(){handleToggleFeatures($noHeaderShare)}),$noHeaderShare.is(":checked")&&handleToggleFeatures($noHeaderShare);var file_frame;$("#upload_email_banner_image").click(function(e){e.preventDefault(),file_frame&&file_frame.open(),file_frame=wp.media.frames.file_frame=wp.media({title:jQuery(this).data("uploader_title"),button:{text:jQuery(this).data("uploader_button_text")},multiple:!1}),file_frame.on("select",function(){attachment=file_frame.state().get("selection").first().toJSON();var imgurl=attachment.url;$("#banner_image").val(imgurl),showOverlay()}),file_frame.open()}),$(".ib_fields-table input,.ib_fields-table select").on("change",function(){showOverlay()}),$(".ui-slider").on("slidechange",function(){showOverlay()}),$('[data-type="color-picker"]').on("click",function(){showOverlay()});var post={nonce:ibKwAjax.ibKwNonce,action:"ib_get_email_template_preview"};$.ajax({url:ibKwAjax.ajaxurl,dataType:"json",type:"post",data:post,success:function(responseText,status){var template=responseText.template;$("#ib-email-template-iframe").contents().find("html").html(template)},error:function(jqXhr,textStatus,errorThrown){console.log(errorThrown),_lockClick=!1}});var $previewIframe,$emailContent,overlay_showing=!1});