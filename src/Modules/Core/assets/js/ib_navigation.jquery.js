!function($){$.fn.ib_navigation=function(method){var _ibThis,_navigation,_editButton,_availableOptions,_wpBody,defaults={data:"",location:"top",nav_cookie_name:"inboundbrew_side_nav_state"},methods={init:function(options){if("top"==settings.location){_navigation=_ibThis.find("#ib_nav_items"),_navigation.sortable({placeholder:"ib-nav-sortable-placeholder",start:function(event,ui){ui.placeholder.css("width",ui.helper.width())},stop:function(event,ui){removeFromNav&&(methods.removeFromNav($(ui.item)),removeFromNav=!1)}}),_navigation.sortable("option","disabled",!0);var $options=$(".ib-nav-options");$options.droppable({drop:function(event,ui){removeFromNav=!0}}),_navigation.bind("click",function(event){editMode||methods.goToModule($(event.target))}),$options.children().draggable({connectToSortable:_navigation,helper:"clone",revert:"invalid",cancel:".inactive",start:function(event,ui){$(this).draggable("option","cursorAt",{left:Math.floor(ui.helper.width()/2),top:Math.floor(ui.helper.height()/2)})},stop:function(event,ui){methods.checkActiveNavigation()}}),_editButton=$("#ib_edit_nav"),_availableOptions=$("#top_nav_available_options"),_editButton.click(function(){editMode?(_navigation.sortable("disable"),_availableOptions.slideUp(),methods.saveNavigation(),editMode=!1):(_navigation.sortable("option","disabled",!1),_availableOptions.slideDown(),editMode=!0)})}else{_navigation=_ibThis.find("#ib_navigation_items"),_navigation.children().each(function(){$(this).click(function(){var $me=$(this);editMode||methods.goToModule($me)})}),_ibThis.find("#ib_collapse_menu").click(function(){editMode||methods.toggleSideNavCollapse()}),_ibThis.find("#ib_edit_nav").click(function(){methods.editSideNav(!editMode,$(this))}),_wpBody=$("body");$("#toplevel_page_inboundbrew").children("a").css("background");_navigation=_ibThis.find("#ib_navigation_items"),_navigation.sortable({items:"li:not(.ib_locked)",placeholder:"ib-nav-sortable-placeholder",start:function(event,ui){},stop:function(event,ui){ui.item.attr("style",""),removeFromNav&&(methods.removeFromNav($(ui.item)),removeFromNav=!1)}}),_navigation.sortable("option","disabled",!0),_availableOptions=$("#side_nav_available_options .options-inner"),_availableOptions.droppable({drop:function(event,ui){removeFromNav=!0}}),_availableOptions.find(".ib-nav-options").children().draggable({connectToSortable:_navigation,helper:"clone",revert:"invalid",cancel:".inactive",start:function(event,ui){ui.helper.css("width","162px").css("padding","5px"),$(this).draggable("option","cursorAt",{left:Math.floor(ui.helper.width()/2),top:Math.floor(ui.helper.height()/2)})},stop:function(event,ui){methods.checkActiveNavigation()}})}},editSideNav:function(edit,$edit_button){edit?($("#side_nav_available_options").show(),_navigation.sortable("option","disabled",!1),_availableOptions.animate({left:0},500),_wpBody.removeClass("ib_collapsed"),_navigation.parent().addClass("in-edit-mode"),editMode=!0,$edit_button.find(".ib_nav-name").html("Save Changes")):(_navigation.sortable("disable"),_availableOptions.animate({left:-212},500,function(){$("#side_nav_available_options").hide()}),methods.saveNavigation(),editMode=!1,_navigation.parent().removeClass("in-edit-mode"),$edit_button.find(".ib_nav-name").html("Edit Menu"))},setCookie:function(c_name,value,expiredays){var exdate=new Date;exdate.setDate(exdate.getDate()+expiredays),document.cookie=c_name+"="+escape(value)+(null==expiredays?"":";expires="+exdate.toGMTString())},getCookie:function(c_name){return document.cookie.length>0&&(c_start=document.cookie.indexOf(c_name+"="),c_start!=-1)?(c_start=c_start+c_name.length+1,c_end=document.cookie.indexOf(";",c_start),c_end==-1&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""},deleteCookie:function(c_name){setCookie(c_name,"",-1)},toggleSideNavCollapse:function(){_wpBody.hasClass("ib_collapsed")?methods.navState(!1):methods.navState(!0)},navState:function(is_collapsed){var nav_state="";is_collapsed?(_wpBody.addClass("ib_collapsed"),nav_state="collapsed"):_wpBody.removeClass("ib_collapsed");var nav_state=methods.setCookie(settings.nav_cookie_name,nav_state,1e3)},checkActiveNavigation:function(){$(".ib-nav-options li").each(function(){var $me=$(this),index=$me.attr("data-index"),$nav=_navigation.find('li[data-index="'+index+'"]');$nav.length>0?$me.addClass("inactive"):$me.removeClass("inactive")})},goToModule:function($nav_item){var href=$nav_item.attr("data-href"),loc="admin.php?page="+href;window.location.href=loc},removeFromNav:function($nav_item){var index=$nav_item.attr("data-index"),$option=_ibThis.find('ul.ib-nav-options li[data-index="'+index+'"]');$option.removeClass("inactive"),$nav_item.remove()},saveNavigation:function(){var nonce=ibNavAjax.ibNavNonce,order=[];_navigation.find("li").each(function(){order.push($(this).attr("data-index"))}),data={nonce:nonce,order:order,action:"ib_save_navigation_order"},$.ajax({type:"POST",dataType:"json",url:ibNavAjax.ajaxurl,data:data,success:function(responseText){},error:function(){}})}},removeFromNav=!1,editMode=!1,settings=$.extend({},defaults,method);return methods[method]?(_ibThis=$(this),methods[method].apply(this,Array.prototype.slice.call(arguments,1))):"object"!=typeof method&&method?void $.error("Method "+method+" does not exist on jQuery.ib_navigation"):this.each(function(){_ibThis=$(this),methods.init()})}}(jQuery);